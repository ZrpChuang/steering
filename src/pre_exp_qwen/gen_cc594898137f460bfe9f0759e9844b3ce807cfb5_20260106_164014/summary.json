{
  "args": {
    "inference_json": "",
    "question_file": "/data/ruipeng.zhang/dpo_on/AMBER/data/query/query_all.json",
    "image_folder": "/data/ruipeng.zhang/dpo_on/playground/AMBER_image",
    "image_cache_folder": "/nas_data/ruipeng.zhang/AMBER_image_pre_qwen",
    "annotation": "/data/ruipeng.zhang/dpo_on/AMBER/data/annotations.json",
    "relation": "/data/ruipeng.zhang/dpo_on/AMBER/data/relation.json",
    "safe_words": "/data/ruipeng.zhang/dpo_on/AMBER/data/safe_words.txt",
    "model_path": "/data/base_model/models--Qwen--Qwen2.5-VL-7B-Instruct/snapshots/cc594898137f460bfe9f0759e9844b3ce807cfb5",
    "device": "cuda",
    "dtype": "bf16",
    "seed": 42,
    "gen_max_new_tokens": 256,
    "gen_temperature": 0.0,
    "gen_num_beams": 1,
    "max_answer_tokens": 200,
    "max_samples": 1000,
    "similarity_score": 0.8,
    "only_id": -1,
    "start_idx": 0,
    "n_samples": 10,
    "spacy_model": "/data/ruipeng.zhang/anaconda3/envs/mdpo/lib/python3.12/site-packages/en_core_web_lg/en_core_web_lg-3.8.0",
    "output_root": "/data/ruipeng.zhang/steering/src/pre_exp_qwen",
    "run_tag": "",
    "no_save_token_csv": false,
    "objclean_window": 2,
    "no_objclean": false
  },
  "notes": {
    "noimg_definition": "text-only inputs: no image placeholder tokens; pixel_values not provided (true no-image branch)",
    "img_definition": "prefer image-only cache (pixel_values + image_grid_thw); fallback online PIL+_build_inputs",
    "max_answer_tokens": 200,
    "rate_definition": "rate[k]=count[k]/denom[k], denom[k]=#(len>=k)",
    "visual_sensitivity": "Î”_t = logp_img(x_t) - logp_noimg(x_t) on teacher-forced answer tokens",
    "ppl": "PPL_img = exp(mean NLL over truncated tokens)",
    "offset_policy": "offsets recovered via prefix decode diff",
    "subset_run": "supported via --only-id / --start-idx / --n-samples (with --max-samples as cap)",
    "token_csv_default": "delta_tokens.csv.gz is saved by default; use --no-save-token-csv to disable",
    "objclean_default": "objclean denoise runs by default; use --no-objclean to disable"
  },
  "tf_cache": {
    "image_cache_folder": "/nas_data/ruipeng.zhang/AMBER_image_pre_qwen",
    "hit": 10,
    "miss": 0
  },
  "delta_summary": {
    "__all__": {
      "delta": {
        "n": 999,
        "mean": 0.7916639908417329,
        "median": 0.085235595703125
      },
      "abs_delta": {
        "n": 999,
        "mean": 0.8914981160435949,
        "median": 0.2046661376953125
      }
    },
    "function": {
      "delta": {
        "n": 402,
        "mean": 0.49774511536555505,
        "median": 0.019987106323242188
      },
      "abs_delta": {
        "n": 402,
        "mean": 0.5879812288047069,
        "median": 0.11277008056640625
      }
    },
    "hallu": {
      "delta": {
        "n": 8,
        "mean": 2.9822120666503906,
        "median": 2.9850101470947266
      },
      "abs_delta": {
        "n": 8,
        "mean": 2.9822120666503906,
        "median": 2.9850101470947266
      }
    },
    "object": {
      "delta": {
        "n": 248,
        "mean": 0.8080289825316398,
        "median": 0.21431350708007812
      },
      "abs_delta": {
        "n": 248,
        "mean": 0.9451755477536109,
        "median": 0.35262584686279297
      }
    },
    "other": {
      "delta": {
        "n": 341,
        "mean": 1.0748677603310504,
        "median": 0.1827239990234375
      },
      "abs_delta": {
        "n": 341,
        "mean": 1.1612226732315556,
        "median": 0.32049560546875
      }
    }
  },
  "ppl_img_summary": {
    "n": 10,
    "mean": 1.6224270563667276,
    "median": 1.6366681725581615
  },
  "token_csv": {
    "saved": true,
    "path": "/data/ruipeng.zhang/steering/src/pre_exp_qwen/gen_cc594898137f460bfe9f0759e9844b3ce807cfb5_20260106_164014/delta_tokens.csv.gz",
    "token_records_n": 999
  }
}