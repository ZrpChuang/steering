{
  "args": {
    "inference_json": "",
    "question_file": "/data/ruipeng.zhang/dpo_on/AMBER/data/query/query_all.json",
    "image_folder": "/data/ruipeng.zhang/dpo_on/playground/AMBER_image",
    "image_cache_folder": "/data/ruipeng.zhang/dpo_on/playground/AMBER_image_pre_llava",
    "annotation": "/data/ruipeng.zhang/dpo_on/AMBER/data/annotations.json",
    "word_association": "/data/ruipeng.zhang/dpo_on/AMBER/data/relation.json",
    "safe_words": "/data/ruipeng.zhang/dpo_on/AMBER/data/safe_words.txt",
    "model_path": "/data/base_model/base_models_mllms/llava-v1.5-7b",
    "model_base": null,
    "conv_mode": "llava_v1",
    "device": "cuda",
    "seed": 42,
    "gen_max_new_tokens": 256,
    "gen_temperature": 0.0,
    "gen_num_beams": 1,
    "max_answer_tokens": 200,
    "max_samples": 3,
    "similarity_score": 0.8,
    "output_root": "/data/ruipeng.zhang/steering/src/pre_exp_llava",
    "run_tag": "",
    "save_token_csv": false
  },
  "notes": {
    "noimg_definition": "use_image=False -> prompt 不含 image token 且 images=None（真正无图）",
    "img_definition": "优先 cache pixel_values(<image_file>.pt)；cache miss 回退 PIL+preprocess",
    "max_answer_tokens": 200,
    "rate_definition": "rate[k]=count[k]/denom[k], denom[k]=#(len>=k)",
    "visual_sensitivity": "Δ_t = logp_img(x_t) - logp_noimg(x_t) on teacher-forced response tokens",
    "ppl": "PPL_img = exp(mean NLL over truncated tokens)",
    "inference_policy": "given inference-json -> read only; else generate and save generated_inference.json",
    "offset_policy": "NO fast tokenizer offset_mapping; offsets recovered via prefix decode diff (same tokenizer, self-consistent)",
    "logits_alignment_fix": "If logits_len >> input_len and IMAGE_TOKEN_INDEX exists, map input index j -> expanded index j_exp then use logits[j_exp-1]."
  },
  "tf_cache": {
    "cache_folder": "/data/ruipeng.zhang/dpo_on/playground/AMBER_image_pre_llava",
    "hit": 3,
    "miss": 0
  },
  "alignment_expansion_stats": {
    "n_samples_ok": 3,
    "n_need_fix_img": 3,
    "n_fix_ok_img": 3,
    "diff_hist_img": {
      "575": 3
    },
    "extra_hist_img": {
      "575": 3
    }
  },
  "delta_summary": {
    "__all__": {
      "delta": {
        "n": 260,
        "mean": 0.20378456115722657,
        "median": -0.019878387451171875
      },
      "abs_delta": {
        "n": 260,
        "mean": 0.4551429014939528,
        "median": 0.16141128540039062
      }
    },
    "function": {
      "delta": {
        "n": 95,
        "mean": -0.015165670294510691,
        "median": -0.0341033935546875
      },
      "abs_delta": {
        "n": 95,
        "mean": 0.2411297045255962,
        "median": 0.13402557373046875
      }
    },
    "hallu": {
      "delta": {
        "n": 3,
        "mean": -0.2233149210611979,
        "median": -0.0002803802490234375
      },
      "abs_delta": {
        "n": 3,
        "mean": 0.2233149210611979,
        "median": 0.0002803802490234375
      }
    },
    "object": {
      "delta": {
        "n": 58,
        "mean": 0.3307761159436456,
        "median": -0.03326892852783203
      },
      "abs_delta": {
        "n": 58,
        "mean": 0.5723559609774885,
        "median": 0.15996932983398438
      }
    },
    "other": {
      "delta": {
        "n": 104,
        "mean": 0.3452851405510536,
        "median": -0.000186920166015625
      },
      "abs_delta": {
        "n": 104,
        "mean": 0.5919542496020977,
        "median": 0.18241214752197266
      }
    }
  },
  "ppl_img_summary": {
    "n": 3,
    "mean": 1.6984399934524845,
    "median": 1.7262397128114417
  }
}