{
  "args": {
    "inference_json": "",
    "question_file": "/data/ruipeng.zhang/dpo_on/AMBER/data/query/query_all.json",
    "image_folder": "/data/ruipeng.zhang/dpo_on/playground/AMBER_image",
    "image_cache_folder": "",
    "annotation": "/data/ruipeng.zhang/dpo_on/AMBER/data/annotations.json",
    "word_association": "/data/ruipeng.zhang/dpo_on/AMBER/data/relation.json",
    "safe_words": "/data/ruipeng.zhang/dpo_on/AMBER/data/safe_words.txt",
    "model_path": "/data/base_model/base_models_mllms/llava-v1.5-7b",
    "model_base": null,
    "conv_mode": "llava_v1",
    "device": "cuda",
    "seed": 42,
    "gen_max_new_tokens": 256,
    "gen_temperature": 0.0,
    "gen_num_beams": 1,
    "max_answer_tokens": 200,
    "max_samples": 3,
    "similarity_score": 0.8,
    "output_root": "/data/ruipeng.zhang/steering/src/pre_exp_llava",
    "run_tag": "",
    "save_token_csv": false
  },
  "notes": {
    "noimg_definition": "use_image=False -> prompt 不含 image token 且 images=None（真正无图）",
    "img_definition": "优先 cache pixel_values(<image_file>.pt)；cache miss 回退 PIL+preprocess",
    "max_answer_tokens": 200,
    "rate_definition": "rate[k]=count[k]/denom[k], denom[k]=#(len>=k)",
    "visual_sensitivity": "Δ_t = logp_img(x_t) - logp_noimg(x_t) on teacher-forced response tokens",
    "ppl": "PPL_img = exp(mean NLL over truncated tokens)",
    "inference_policy": "given inference-json -> read only; else generate and save generated_inference.json",
    "offset_policy": "NO fast tokenizer offset_mapping; offsets recovered via prefix decode diff (same tokenizer, self-consistent)"
  },
  "tf_cache": {
    "cache_folder": "",
    "hit": 0,
    "miss": 3
  },
  "delta_summary": {
    "__all__": {
      "delta": {
        "n": 260,
        "mean": -7.666304561364375,
        "median": -7.484401306885737
      },
      "abs_delta": {
        "n": 260,
        "mean": 7.686945292545032,
        "median": 7.484401306885737
      }
    },
    "function": {
      "delta": {
        "n": 95,
        "mean": -5.791968473945765,
        "median": -5.462637400679972
      },
      "abs_delta": {
        "n": 95,
        "mean": 5.791968473945765,
        "median": 5.462637400679972
      }
    },
    "hallu": {
      "delta": {
        "n": 3,
        "mean": -11.635564021613055,
        "median": -11.211121947500441
      },
      "abs_delta": {
        "n": 3,
        "mean": 11.635564021613055,
        "median": 11.211121947500441
      }
    },
    "object": {
      "delta": {
        "n": 58,
        "mean": -9.72568173569389,
        "median": -9.8388370969837
      },
      "abs_delta": {
        "n": 58,
        "mean": 9.810230919826118,
        "median": 9.8388370969837
      }
    },
    "other": {
      "delta": {
        "n": 104,
        "mean": -8.115441809565432,
        "median": -8.184894493630715
      },
      "abs_delta": {
        "n": 104,
        "mean": 8.119891207904871,
        "median": 8.184894493630715
      }
    }
  },
  "ppl_img_summary": {
    "n": 3,
    "mean": 4336.479675549038,
    "median": 4332.0617326574165
  }
}