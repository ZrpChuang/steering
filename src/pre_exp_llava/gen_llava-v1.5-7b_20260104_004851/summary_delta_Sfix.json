{
  "workdir": "/data/ruipeng.zhang/steering/src/pre_exp_llava/gen_llava-v1.5-7b_20260104_004851",
  "inputs": {
    "inference_json": "/data/ruipeng.zhang/steering/src/pre_exp_llava/gen_llava-v1.5-7b_20260104_004851/generated_inference.json",
    "annotation": "/data/ruipeng.zhang/dpo_on/AMBER/data/annotations.json",
    "relation": "/data/ruipeng.zhang/dpo_on/AMBER/data/relation.json",
    "safe_words": "/data/ruipeng.zhang/dpo_on/AMBER/data/safe_words.txt",
    "question_file": "/data/ruipeng.zhang/dpo_on/AMBER/data/query/query_all.json",
    "image_folder": "/data/ruipeng.zhang/dpo_on/playground/AMBER_image",
    "image_cache_folder": "/data/ruipeng.zhang/dpo_on/playground/AMBER_image_pre_llava",
    "model_path": "/data/base_model/base_models_mllms/llava-v1.5-7b",
    "spacy_model": "/data/ruipeng.zhang/anaconda3/envs/mdpo/lib/python3.12/site-packages/en_core_web_lg/en_core_web_lg-3.8.0",
    "nltk_data_dir": "/data/ruipeng.zhang/steering/src/pre_exp_llava/nltk_data"
  },
  "params": {
    "max_samples": 1000,
    "maxK": 200,
    "similarity_score": 0.8,
    "image_token_index": -200
  },
  "counts": {
    "used_samples": 1000,
    "skipped": 0,
    "forward_fail": 0,
    "align_fail": 0,
    "tf_cache_hit": 1000,
    "tf_cache_miss": 0
  },
  "alignment_expansion_stats": {
    "n_samples_ok": 1000,
    "n_need_fix_img": 1000,
    "n_fix_ok_img": 1000,
    "diff_hist_img": {
      "575": 1000
    },
    "extra_hist_img": {
      "575": 1000
    }
  },
  "delta_summary_by_type": {
    "__all__": {
      "delta": {
        "n": 96321,
        "mean": 0.21516959716042497,
        "median": -0.013271331787109375,
        "std": 1.0878788693544574
      },
      "abs_delta": {
        "n": 96321,
        "mean": 0.45441783848157946,
        "median": 0.14789962768554688,
        "std": 1.0115744253389571
      }
    },
    "function": {
      "delta": {
        "n": 36685,
        "mean": 0.012419929208036695,
        "median": -0.032520294189453125,
        "std": 0.4953808881627184
      },
      "abs_delta": {
        "n": 36685,
        "mean": 0.26039359332008355,
        "median": 0.1308460235595703,
        "std": 0.4216060430737104
      }
    },
    "hallu": {
      "delta": {
        "n": 674,
        "mean": 0.35725195683782107,
        "median": -0.0008096694946289062,
        "std": 1.3571503137362304
      },
      "abs_delta": {
        "n": 674,
        "mean": 0.6507869431809785,
        "median": 0.2079944610595703,
        "std": 1.2433673187453333
      }
    },
    "object": {
      "delta": {
        "n": 25552,
        "mean": 0.4120517091297252,
        "median": -0.001445770263671875,
        "std": 1.4473133486891185
      },
      "abs_delta": {
        "n": 25552,
        "mean": 0.613217376139885,
        "median": 0.13541793823242188,
        "std": 1.3742150449949788
      }
    },
    "other": {
      "delta": {
        "n": 33410,
        "mean": 0.28435176816824415,
        "median": -0.004528999328613281,
        "std": 1.1930388470052324
      },
      "abs_delta": {
        "n": 33410,
        "mean": 0.5420497113022038,
        "median": 0.1834249496459961,
        "std": 1.100172590551673
      }
    }
  },
  "auc": {
    "auc_abs_delta_for_hallu": 0.5331734466613589,
    "auc_raw_delta_for_hallu": 0.5208139697904377,
    "note": "AUC 用于衡量 score(如 |delta|) 区分 hallu token 的能力；None 表示样本全同类或为空。"
  },
  "position_stats": {
    "hallu_mean_abs_delta_by_pos": {
      "93": 0.5223393440246582,
      "94": 0.6387216394597833,
      "95": 0.02496496836344401,
      "22": 0.07933425903320312,
      "102": 0.6017572614881728,
      "103": 0.3802045186360677,
      "71": 0.5203595161437988,
      "64": 0.5488726298014323,
      "69": 0.45445696512858075,
      "109": 0.22406705220540366,
      "34": 0.772736930847168,
      "35": 0.08582878112792969,
      "38": 0.39988263448079425,
      "39": 0.0332855224609375,
      "14": 3.374645233154297,
      "74": 0.2697944641113281,
      "17": 1.3773903846740723,
      "18": 0.012905120849609375,
      "59": 0.6390046013726128,
      "60": 0.4974361419677734,
      "77": 0.8228633880615235,
      "70": 0.47754542032877606,
      "88": 0.3694812774658203,
      "100": 1.0092055002848308,
      "101": 0.4256347020467122,
      "117": 0.050018310546875,
      "32": 1.070558336046007,
      "33": 0.7247825622558594,
      "63": 0.15678119659423828,
      "9": 3.2207820892333983,
      "28": 0.9000520706176758,
      "72": 0.5179641030051492,
      "73": 0.8465799604143415,
      "83": 0.4069085121154785,
      "84": 0.7908382415771484,
      "26": 1.1724586486816406,
      "27": 0.3726381574358259,
      "55": 0.4506079355875651,
      "56": 0.7390323215060763,
      "112": 0.4957691828409831,
      "113": 0.08176670074462891,
      "48": 0.5484447479248047,
      "58": 0.30664539337158203,
      "10": 1.7283096313476562,
      "67": 0.9356935024261475,
      "79": 0.10709163120814733,
      "80": 0.4140943799700056,
      "40": 0.3058331807454427,
      "41": 0.11208234514508929,
      "42": 0.8075504302978516,
      "43": 0.7767667770385742,
      "99": 0.23900108337402343,
      "81": 0.40434156145368305,
      "31": 0.6244121789932251,
      "91": 0.4846150080362956,
      "92": 0.2192096710205078,
      "21": 0.00772857666015625,
      "23": 0.31304359436035156,
      "24": 0.2776743570963542,
      "44": 0.18121814727783203,
      "45": 0.07060718536376953,
      "46": 6.29425048828125e-05,
      "47": 0.33510360717773435,
      "65": 0.17296671867370605,
      "66": 0.7530601024627686,
      "68": 0.896420054965549,
      "75": 0.4536876678466797,
      "76": 0.33611170450846356,
      "85": 0.32537994384765623,
      "86": 0.27650206429617746,
      "6": 2.9395275115966797,
      "87": 0.7097377777099609,
      "20": 0.6393098831176758,
      "15": 1.0596668243408203,
      "54": 0.1952392578125,
      "118": 0.2811565399169922,
      "37": 0.24788379669189453,
      "13": 2.7007222175598145,
      "16": 0.3079708947075738,
      "29": 0.04780845642089844,
      "30": 1.1536865234375,
      "62": 0.25227705637613934,
      "106": 0.13730621337890625,
      "107": 0.2964464823404948,
      "108": 0.5880119323730468,
      "49": 0.8556737899780273,
      "50": 0.9997003078460693,
      "52": 0.5540170669555664,
      "89": 0.2988114356994629,
      "90": 2.2462299346923826,
      "96": 0.09545453389485677,
      "53": 1.2909170786539714,
      "25": 0.7729746500651041,
      "111": 0.9064197540283203,
      "36": 0.35445276896158856,
      "78": 0.47282436915806364,
      "7": 0.3009934425354004,
      "11": 0.58892822265625,
      "51": 0.48671770095825195,
      "97": 1.1130995750427246,
      "57": 0.11557261149088542,
      "104": 0.07304890950520833,
      "19": 4.068240165710449,
      "119": 0.2300281524658203,
      "82": 0.3932383855183919,
      "110": 0.20589351654052734,
      "122": 0.23218345642089844,
      "123": 8.0108642578125e-05,
      "124": 0.0,
      "105": 0.25679588317871094,
      "98": 0.454254150390625,
      "116": 0.7429351806640625,
      "61": 0.24807167053222656,
      "114": 0.03143119812011719,
      "12": 1.4682931900024414,
      "128": 0.1035451889038086,
      "5": 5.5525390625
    },
    "nonhallu_mean_abs_delta_by_pos": {
      "1": 0.6153028907775879,
      "2": 0.08250487899780273,
      "3": 0.7765854434967041,
      "4": 0.23742762565612793,
      "5": 3.445390340910485,
      "6": 2.436425749492741,
      "7": 1.2771120473562954,
      "8": 0.9301500673294067,
      "9": 1.3984301313083976,
      "10": 1.2933211542688468,
      "11": 1.0131743537695386,
      "12": 0.8589276837442585,
      "13": 0.8693128982222224,
      "14": 0.9321091141499264,
      "15": 0.8303461755340423,
      "16": 0.7537256860588681,
      "17": 0.7064090387888223,
      "18": 0.6631287429519073,
      "19": 0.5709152480205858,
      "20": 0.5031465828837219,
      "21": 0.49199881104524723,
      "22": 0.3838915619233188,
      "23": 0.40903413176297665,
      "24": 0.41617842591036047,
      "25": 0.4210850783551827,
      "26": 0.3816427301477503,
      "27": 0.39118843424356237,
      "28": 0.37387108658880774,
      "29": 0.37013345363751127,
      "30": 0.3512208370615539,
      "31": 0.3458680712407635,
      "32": 0.3095222852304653,
      "33": 0.2861991326413562,
      "34": 0.3173076080553459,
      "35": 0.29431340104377485,
      "36": 0.32534483275418297,
      "37": 0.33444898996794487,
      "38": 0.3332618208718252,
      "39": 0.3548501182441136,
      "40": 0.35487362661715616,
      "41": 0.32578669333866117,
      "42": 0.3564234776712542,
      "43": 0.36641178956214093,
      "44": 0.32463145304014024,
      "45": 0.3574202903303277,
      "46": 0.34097199449558296,
      "47": 0.3477575589664018,
      "48": 0.34814691928125197,
      "49": 0.3077089182664119,
      "50": 0.35882774587837163,
      "51": 0.31053461621155093,
      "52": 0.31237495545170435,
      "53": 0.3096341837590663,
      "54": 0.32601183250711524,
      "55": 0.30027278488682163,
      "56": 0.2762378960968512,
      "57": 0.3103517605486118,
      "58": 0.32858670036199733,
      "59": 0.3409074713116043,
      "60": 0.31257545471191406,
      "61": 0.2959182372234739,
      "62": 0.3113988498397921,
      "63": 0.322152622993746,
      "64": 0.3123736685470852,
      "65": 0.2927333647463502,
      "66": 0.2964254079285641,
      "67": 0.32906317199248614,
      "68": 0.2988307722322233,
      "69": 0.34967768430181195,
      "70": 0.3176795725613263,
      "71": 0.33808732197202485,
      "72": 0.2983348720626921,
      "73": 0.3377074878176148,
      "74": 0.3035607570555152,
      "75": 0.2959370194613123,
      "76": 0.26295141828408536,
      "77": 0.25717515995105106,
      "78": 0.262477854652053,
      "79": 0.2399925948789456,
      "80": 0.30496150568911906,
      "81": 0.2307241104817593,
      "82": 0.2553207173066981,
      "83": 0.231554596564349,
      "84": 0.2406351798918189,
      "85": 0.23739936243573637,
      "86": 0.24178007441194635,
      "87": 0.24003697692370807,
      "88": 0.24041607895412961,
      "89": 0.2316854173336887,
      "90": 0.25079489008359757,
      "91": 0.2335503384661631,
      "92": 0.23345404596471075,
      "96": 0.23963136692556267,
      "97": 0.2238735587582023,
      "98": 0.21266569752074685,
      "99": 0.23295371585422092,
      "100": 0.22168766858890585,
      "101": 0.23068727576980413,
      "102": 0.20612864019746463,
      "103": 0.20508366764181912,
      "104": 0.22267875861172653,
      "105": 0.2142602048178976,
      "106": 0.21318469656274674,
      "107": 0.19741392005691735,
      "108": 0.22286615072831809,
      "109": 0.2203058676030432,
      "110": 0.2476805036313066,
      "111": 0.22272550093161092,
      "112": 0.24535318733989328,
      "113": 0.2019331117242689,
      "114": 0.2243829937431756,
      "115": 0.18882071385618115,
      "116": 0.20959520131739987,
      "117": 0.19373193153968224,
      "118": 0.19480597006308065,
      "119": 0.21032135009765626,
      "120": 0.1975797698611305,
      "121": 0.19647286862743144,
      "122": 0.24147838354110718,
      "123": 0.20721721649169922,
      "124": 0.16623050825936453,
      "125": 0.18212732587541852,
      "126": 0.2323226071475597,
      "93": 0.2328309458355571,
      "94": 0.23290891704445113,
      "95": 0.23026025560167102,
      "127": 0.16398555476491045,
      "128": 0.28408169023918384,
      "129": 0.26102287428719656,
      "130": 0.2960472106933594,
      "131": 0.24737762269519625,
      "132": 0.24324837709084535,
      "133": 0.182811525132921,
      "134": 0.23476230396943934,
      "135": 0.26065233775547575,
      "136": 0.1577629852294922,
      "137": 0.37143536617881373,
      "138": 0.2116662343343099,
      "139": 0.3705026626586914,
      "140": 1.0708253648546007,
      "141": 0.12436747550964355,
      "142": 0.07773526509602864,
      "143": 0.2635806401570638,
      "144": 0.13967037200927734,
      "145": 0.27995967864990234,
      "146": 0.05902576446533203,
      "147": 8.7738037109375e-05,
      "148": 2.6702880859375e-05,
      "149": 0.03681182861328125,
      "150": 0.15059852600097656,
      "151": 3.62396240234375e-05,
      "152": 5.7220458984375e-06,
      "153": 0.5269966125488281
    },
    "hallu_count_by_pos": {
      "93": 8,
      "94": 11,
      "95": 6,
      "22": 3,
      "102": 9,
      "103": 12,
      "71": 8,
      "64": 6,
      "69": 12,
      "109": 3,
      "34": 10,
      "35": 6,
      "38": 6,
      "39": 5,
      "14": 6,
      "74": 13,
      "17": 4,
      "18": 2,
      "59": 9,
      "60": 10,
      "77": 10,
      "70": 12,
      "88": 5,
      "100": 6,
      "101": 6,
      "117": 1,
      "32": 9,
      "33": 5,
      "63": 8,
      "9": 5,
      "28": 6,
      "72": 11,
      "73": 7,
      "83": 8,
      "84": 10,
      "26": 1,
      "27": 7,
      "55": 6,
      "56": 9,
      "112": 6,
      "113": 10,
      "48": 8,
      "58": 6,
      "10": 7,
      "67": 8,
      "79": 7,
      "80": 7,
      "40": 3,
      "41": 7,
      "42": 5,
      "43": 6,
      "99": 10,
      "81": 7,
      "31": 8,
      "91": 6,
      "92": 2,
      "21": 2,
      "23": 2,
      "24": 3,
      "44": 6,
      "45": 4,
      "46": 2,
      "47": 5,
      "65": 8,
      "66": 8,
      "68": 18,
      "75": 8,
      "76": 9,
      "85": 5,
      "86": 7,
      "6": 3,
      "87": 6,
      "20": 3,
      "15": 5,
      "54": 5,
      "118": 3,
      "37": 6,
      "13": 4,
      "16": 9,
      "29": 5,
      "30": 6,
      "62": 6,
      "106": 4,
      "107": 3,
      "108": 5,
      "49": 8,
      "50": 8,
      "52": 4,
      "89": 4,
      "90": 5,
      "96": 6,
      "53": 3,
      "25": 3,
      "111": 3,
      "36": 3,
      "78": 7,
      "7": 4,
      "11": 7,
      "51": 4,
      "97": 4,
      "57": 3,
      "104": 3,
      "19": 4,
      "119": 1,
      "82": 6,
      "110": 2,
      "122": 1,
      "123": 1,
      "124": 1,
      "105": 4,
      "98": 2,
      "116": 1,
      "61": 7,
      "114": 2,
      "12": 2,
      "128": 2,
      "5": 5
    },
    "nonhallu_count_by_pos": {
      "1": 1000,
      "2": 1000,
      "3": 1000,
      "4": 1000,
      "5": 995,
      "6": 997,
      "7": 996,
      "8": 1000,
      "9": 995,
      "10": 993,
      "11": 993,
      "12": 998,
      "13": 996,
      "14": 994,
      "15": 995,
      "16": 991,
      "17": 996,
      "18": 998,
      "19": 996,
      "20": 997,
      "21": 998,
      "22": 997,
      "23": 998,
      "24": 997,
      "25": 997,
      "26": 999,
      "27": 993,
      "28": 994,
      "29": 995,
      "30": 994,
      "31": 992,
      "32": 991,
      "33": 995,
      "34": 990,
      "35": 994,
      "36": 997,
      "37": 994,
      "38": 994,
      "39": 995,
      "40": 997,
      "41": 993,
      "42": 995,
      "43": 994,
      "44": 994,
      "45": 996,
      "46": 998,
      "47": 995,
      "48": 992,
      "49": 991,
      "50": 991,
      "51": 995,
      "52": 994,
      "53": 995,
      "54": 993,
      "55": 992,
      "56": 988,
      "57": 991,
      "58": 985,
      "59": 978,
      "60": 975,
      "61": 977,
      "62": 974,
      "63": 965,
      "64": 957,
      "65": 952,
      "66": 941,
      "67": 932,
      "68": 910,
      "69": 902,
      "70": 889,
      "71": 870,
      "72": 849,
      "73": 842,
      "74": 820,
      "75": 809,
      "76": 787,
      "77": 768,
      "78": 759,
      "79": 745,
      "80": 722,
      "81": 706,
      "82": 697,
      "83": 680,
      "84": 656,
      "85": 639,
      "86": 623,
      "87": 610,
      "88": 592,
      "89": 578,
      "90": 563,
      "91": 547,
      "92": 536,
      "96": 487,
      "97": 481,
      "98": 478,
      "99": 450,
      "100": 442,
      "101": 433,
      "102": 422,
      "103": 404,
      "104": 402,
      "105": 387,
      "106": 376,
      "107": 367,
      "108": 351,
      "109": 339,
      "110": 321,
      "111": 296,
      "112": 276,
      "113": 261,
      "114": 254,
      "115": 244,
      "116": 229,
      "117": 208,
      "118": 185,
      "119": 175,
      "120": 168,
      "121": 147,
      "122": 128,
      "123": 120,
      "124": 112,
      "125": 105,
      "126": 89,
      "93": 516,
      "94": 501,
      "95": 495,
      "127": 82,
      "128": 66,
      "129": 56,
      "130": 49,
      "131": 42,
      "132": 39,
      "133": 36,
      "134": 34,
      "135": 28,
      "136": 25,
      "137": 19,
      "138": 15,
      "139": 10,
      "140": 9,
      "141": 8,
      "142": 6,
      "143": 6,
      "144": 4,
      "145": 2,
      "146": 2,
      "147": 1,
      "148": 1,
      "149": 1,
      "150": 1,
      "151": 1,
      "152": 1,
      "153": 1
    }
  },
  "outputs": {
    "delta_tokens_csv_gz": "/data/ruipeng.zhang/steering/src/pre_exp_llava/gen_llava-v1.5-7b_20260104_004851/delta_tokens_Sfix.csv.gz",
    "delta_summary_json": "/data/ruipeng.zhang/steering/src/pre_exp_llava/gen_llava-v1.5-7b_20260104_004851/delta_summary_Sfix.json",
    "summary_json": "/data/ruipeng.zhang/steering/src/pre_exp_llava/gen_llava-v1.5-7b_20260104_004851/summary_delta_Sfix.json",
    "plot_mean_abs_delta_by_type": "/data/ruipeng.zhang/steering/src/pre_exp_llava/gen_llava-v1.5-7b_20260104_004851/mean_abs_delta_by_type_Sfix.png"
  }
}